@model ProjectListViewModel

@{
    ViewData["Title"] = "Projects";
}

<section class="projects-page">
    <header class="projects-header">
        <div>
            <p class="projects-subtitle">Workspace history</p>
            <h1 class="projects-title">Previous projects</h1>
            <p class="projects-description">
                Revisit generated projects, review their progress, and jump back into their task boards whenever you need.
            </p>
        </div>
        <a class="projects-action" asp-controller="Project" asp-action="CreateWizard">Create a new project</a>
    </header>

    @if (!Model.HasProjects)
    {
        <div class="projects-empty">
            <h2>No projects yet</h2>
            <p>Create your first project to start organising tasks and keep track of deliverables.</p>
            <a class="projects-action" asp-controller="Project" asp-action="CreateWizard">Start a project</a>
        </div>
    }
    else
    {
        <div class="projects-grid">
            @foreach (var project in Model.Projects)
            {
                var inProgressPercent = project.TotalTasks == 0 ? 0 : (int)System.Math.Round(project.InProgressTasks * 100d / project.TotalTasks);
                var completedPercent = project.TotalTasks == 0 ? 0 : (int)System.Math.Round(project.CompletedTasks * 100d / project.TotalTasks);

                <article class="project-card">
                    <div class="project-card-body">
                        <p class="project-card-meta">Project ID: @project.Id</p>
                        <h2 class="project-card-title">@project.Name</h2>
                        @if (!string.IsNullOrWhiteSpace(project.Description))
                        {
                            <p class="project-card-description">@project.Description</p>
                        }
                        <dl class="project-card-stats">
                            <div>
                                <dt>Total tasks</dt>
                                <dd>@project.TotalTasks</dd>
                            </div>
                            <div>
                                <dt>In progress</dt>
                                <dd>@project.InProgressTasks <span>@inProgressPercent%</span></dd>
                            </div>
                            <div>
                                <dt>Completed</dt>
                                <dd>@project.CompletedTasks <span>@completedPercent%</span></dd>
                            </div>
                        </dl>
                    </div>
                    <a class="project-card-link" asp-controller="Project" asp-action="Details" asp-route-id="@project.Id">
                        View project
                    </a>
                </article>
            }
        </div>
    }
</section>

<style>
    .projects-page {
        background: #fff;
        border-radius: 1.75rem;
        box-shadow: 0 30px 70px rgba(15, 23, 42, 0.08);
        padding: clamp(2rem, 4vw, 3rem);
        display: flex;
        flex-direction: column;
        gap: clamp(2rem, 3vw, 3rem);
    }

    .projects-header {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    @@media (min-width: 992px) {
        .projects-header {
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .projects-header > div {
            max-width: 45rem;
        }
    }

    .projects-subtitle {
        text-transform: uppercase;
        letter-spacing: 0.25rem;
        font-weight: 600;
        color: #6366f1;
        margin-bottom: 0.75rem;
    }

    .projects-title {
        font-size: clamp(2rem, 3.2vw, 3rem);
        font-weight: 700;
        color: #0f172a;
        margin-bottom: 0.75rem;
    }

    .projects-description {
        color: #475569;
        font-size: 1rem;
        margin: 0;
    }

    .projects-action {
        align-self: flex-start;
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        color: #fff;
        font-weight: 600;
        padding: 0.85rem 1.75rem;
        border-radius: 999px;
        text-decoration: none;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        box-shadow: 0 15px 35px rgba(99, 102, 241, 0.25);
    }

    .projects-action:hover,
    .projects-action:focus {
        transform: translateY(-2px);
        box-shadow: 0 20px 45px rgba(99, 102, 241, 0.35);
        color: #fff;
    }

    .projects-empty {
        border: 2px dashed rgba(99, 102, 241, 0.25);
        border-radius: 1.5rem;
        padding: clamp(2rem, 4vw, 3rem);
        text-align: center;
        display: grid;
        gap: 1rem;
    }

    .projects-empty h2 {
        font-size: 1.75rem;
        font-weight: 600;
        margin: 0;
        color: #1e293b;
    }

    .projects-empty p {
        margin: 0;
        color: #475569;
    }

    .projects-grid {
        display: grid;
        gap: 1.5rem;
    }

    @@media (min-width: 768px) {
        .projects-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
    }

    .project-card {
        background: linear-gradient(145deg, rgba(99, 102, 241, 0.08), rgba(14, 165, 233, 0.08));
        border-radius: 1.5rem;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        min-height: 100%;
    }

    .project-card-body {
        padding: 2rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        flex-grow: 1;
    }

    .project-card-meta {
        font-size: 0.9rem;
        font-weight: 500;
        color: #6366f1;
        margin: 0;
    }

    .project-card-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #0f172a;
        margin: 0;
    }

    .project-card-description {
        margin: 0;
        color: #475569;
    }

    .project-card-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
        margin: 0;
    }

    .project-card-stats div {
        background: rgba(255, 255, 255, 0.65);
        border-radius: 1rem;
        padding: 1rem;
        display: grid;
        gap: 0.35rem;
    }

    .project-card-stats dt {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.08rem;
        font-weight: 600;
        color: #64748b;
        margin: 0;
    }

    .project-card-stats dd {
        margin: 0;
        font-size: 1.35rem;
        font-weight: 600;
        color: #1e293b;
        display: flex;
        align-items: baseline;
        gap: 0.5rem;
    }

    .project-card-stats dd span {
        font-size: 0.85rem;
        font-weight: 500;
        color: #6366f1;
    }

    .project-card-link {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1rem 1.5rem;
        background: rgba(15, 23, 42, 0.9);
        color: #fff;
        font-weight: 600;
        text-decoration: none;
        gap: 0.5rem;
        transition: background 0.2s ease;
    }

    .project-card-link:hover,
    .project-card-link:focus {
        background: #0f172a;
        color: #fff;
    }
</style>
